
 public IActionResult SmallCart()
 {
     var cartItems = GetCartItems();

     if (!cartItems.Any())
     {
         return PartialView(null);
     }

     var cartItemProductIds = cartItems.Select(x => x.ProductId).ToList();
     // Load products into memory
     var products = _context.Products
         .Where(p => cartItemProductIds.Contains(p.Id))
         .ToList();

     // Create the ProductCartViewModel list
     
     List<ProductCartViewModel> result = new List<ProductCartViewModel>();
     foreach (var item in products)
     {
         var newItem = new ProductCartViewModel
         {
             Id = item.Id,
             ImageName = item.ImageName,
             Price = item.Price - (item.Discount ?? 0),
             Title = item.Title,
             Count = cartItems.Single(x => x.ProductId == item.Id).Count,
             RowSumPrice = (item.Price - (item.Discount ?? 0)) * cartItems.Single(x => x.ProductId == item.Id).Count,
         };
         
         result.Add(newItem);    
     }

     return PartialView(result);
 }

